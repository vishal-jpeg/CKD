$BodyAccessPackage = @{
    catalogId   = $Catalog.Id
    displayName = $AccessPackageName
    description = $AccessPackageDescription
}

if ($Update) {
    try {
        # Update logic goes here
        $AccessPackage = Get-MgEntitlementManagementAccessPackage -Filter "DisplayName eq '$AccessPackageName'" -ErrorAction Stop
        Write-Host "Fetched existing Access Package for update."
    } catch {
        Write-Warning "Error fetching Access Package for update"
    }
} else {
    try {
        # Creation logic
        $AccessPackage = New-MgBetaEntitlementManagementAccessPackage -BodyParameter $BodyAccessPackage -ErrorAction Stop
        Write-Host "Created new Access Package."
    } catch {
        Write-Warning "Error creating Access Package"
    }
}
