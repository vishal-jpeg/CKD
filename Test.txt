# Known inheritance mapping
$inheritanceMap = @{
    "Advanced Security: view alerts" = "Repository Security Readers"
    "Read" = "Repository Security Readers"
}

foreach ($permName in $permissionsToCheck) {
    Write-Host "`nğŸ” Checking permission: $permName"

    $match = $allPermissions | Where-Object { $_.permissionDisplayName -eq $permName }

    if ($match) {
        if ($match.allow -gt 0) {
            Write-Host "  âœ… [$permName] is ALLOWED (Allow = $($match.allow))"
        } elseif ($match.deny -gt 0) {
            Write-Host "  ğŸš« [$permName] is DENIED (Deny = $($match.deny))"
        } else {
            Write-Host "  âš ï¸ [$permName] exists but not allowed or denied"
        }
    }
    elseif ($inheritanceMap.ContainsKey($permName)) {
        $inheritedGroup = $inheritanceMap[$permName]
        Write-Host "  ğŸ“¥ [$permName] is INHERITED via [$inheritedGroup]"
    }
    else {
        Write-Host "  âŒ [$permName] is NOT SET"
    }
}
